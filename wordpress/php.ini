; TurboStack PHP Configuration - Optimized for WordPress + Docker
; Author: Jo√£o Pedro Frech (https://joaopedrofrech.com/)

; ===================================================================
; PERFORMANCE SETTINGS
; ===================================================================
memory_limit = 512M
max_execution_time = 300
max_input_time = 300
max_input_vars = 3000

; Realpath Cache (performance boost for file operations)
realpath_cache_size = 16M
realpath_cache_ttl = 3600

; ===================================================================
; FILE UPLOAD SETTINGS
; ===================================================================
upload_max_filesize = 100M
post_max_size = 110M
file_uploads = On
max_file_uploads = 20
upload_tmp_dir = /tmp

; ===================================================================
; SESSION & BUFFER SETTINGS
; ===================================================================
session.gc_maxlifetime = 3600
session.cache_expire = 180
session.save_path = /tmp

; Output buffering (WordPress performance - may be overridden by PHP-FPM)
output_buffering = 4096
implicit_flush = Off
zlib.output_compression = Off

; ===================================================================
; ERROR HANDLING & LOGGING (production optimized)
; ===================================================================
display_errors = Off
display_startup_errors = Off
log_errors = Off
error_log = Off
ignore_repeated_errors = On
ignore_repeated_source = On

; ===================================================================
; SECURITY SETTINGS
; ===================================================================
; Request Order (security - only GET and POST, ignore COOKIE data)
request_order = "GP"
variables_order = "GPCS"

; Hide PHP information
expose_php = Off
allow_url_fopen = Off
allow_url_include = Off

; Auto globals
auto_globals_jit = On

; ===================================================================
; OPCACHE OPTIMIZATION (production-tuned)
; ===================================================================
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 128
opcache.interned_strings_buffer = 8
opcache.max_accelerated_files = 10000
opcache.revalidate_freq = 60
opcache.fast_shutdown = 1
opcache.save_comments = 1
opcache.validate_timestamps = 1

; ===================================================================
; FUNCTION SECURITY (hardening)
; ===================================================================
; Disable dangerous functions (security hardening)
; Note: fsockopen & pfsockopen are NOT disabled - required for WordPress emails and WP SMTP
; Note: openlog & syslog kept for WordPress logging compatibility
disable_functions = exec,shell_exec,system,passthru,eval,popen,proc_open,chown,chmod

; ===================================================================
; ADDITIONAL SECURITY & PERFORMANCE
; ===================================================================
; Prevent access to files via HTTP
auto_prepend_file = 
auto_append_file = 

; Limit resources
max_input_nesting_level = 64
max_multipart_body_parts = 1000

; User agent (hide PHP version)
user_agent = "TurboStack"

; Date/Time Settings
date.timezone = "America/Sao_Paulo"
